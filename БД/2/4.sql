SELECT
  DISTINCT "Н_УЧЕНИКИ"."ГРУППА"
FROM
  "Н_УЧЕНИКИ"
WHERE
  "ПЛАН_ИД" IN (
    SELECT
      "ИД"
    FROM
      "Н_ПЛАНЫ"
    WHERE
      "ОТД_ИД" IN (
        SELECT
          "ИД"
        FROM
          "Н_ОТДЕЛЫ"
        WHERE
          "Н_ОТДЕЛЫ"."КОРОТКОЕ_ИМЯ" = 'ВТ'
      )
  )
  AND "КОНЕЦ" >= '2011-01-01 00:00:00.000000'
  and "НАЧАЛО" <= '2011-12-31 00:00:00.000000'
GROUP BY
  "Н_УЧЕНИКИ"."ГРУППА"
HAVING
  count("Н_УЧЕНИКИ"."ГРУППА") < 5;